<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kelola QR Code - Sistem Monitoring Magang PLN ICON+</title>
  <link rel="stylesheet" href="css/cssadmin.css">
  <link rel="icon" href="assets/img/pln-logo-small.svg">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
  <div class="app-wrapper">
    <div class="app-bg"><img src="assets/img/iconnet-banner.jpeg" alt="bg"></div>

    <!-- SIDEBAR OVERLAY -->
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeSidebar()"></div>

    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <button class="sidebar-close-btn" onclick="closeSidebar()"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" x2="6" y1="6" y2="18"/><line x1="6" x2="18" y1="6" y2="18"/></svg></button>
      <div class="sidebar-brand">
        <div class="brand-logo"><img src="assets/img/pln-logo-small.svg" alt="PLN"></div>
        <div class="brand-text"><span class="brand-name">PLN ICON+</span><span class="brand-sub">Admin Panel</span></div>
      </div>
      <nav class="sidebar-menu">
        <a class="menu-item" href="dashboardadmin.html">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/></svg>
          Dashboard
        </a>
        <a class="menu-item active" href="qrcodeadmin.html">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="5" height="5" x="3" y="3" rx="1"/><rect width="5" height="5" x="16" y="3" rx="1"/><rect width="5" height="5" x="3" y="16" rx="1"/><path d="M21 16h-3a2 2 0 0 0-2 2v3"/><path d="M21 21v.01"/><path d="M12 7v3a2 2 0 0 1-2 2H7"/><path d="M3 12h.01"/><path d="M12 3h.01"/><path d="M12 16v.01"/><path d="M16 12h1"/><path d="M21 12v.01"/><path d="M12 21v-1"/></svg>
          Kelola QR Code
        </a>
        <a class="menu-item" href="datapeserta.html">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
          Data Peserta
        </a>
        <a class="menu-item" href="logaktivitas.html">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
          Log Aktivitas
        </a>
        <a class="menu-item" href="kelolakeluhan.html">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
          Kelola Keluhan
        </a>
      </nav>
      <div class="sidebar-footer">
        <a class="menu-item" onclick="logout()">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></svg>
          Keluar
        </a>
      </div>
    </aside>

    <!-- MAIN -->
    <div class="main-content">
      <header class="topbar">
        <button class="mobile-menu-btn" onclick="openSidebar()" aria-label="Menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" x2="21" y1="6" y2="6"/><line x1="3" x2="21" y1="12" y2="12"/><line x1="3" x2="21" y1="18" y2="18"/></svg></button>
        <span class="topbar-title">Sistem Monitoring Magang</span>
        <div class="topbar-right">
          <div class="topbar-search">
            <span class="search-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" x2="16.65" y1="21" y2="16.65"/></svg></span>
            <input type="text" placeholder="Cari...">
          </div>
          <div class="topbar-notif"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"/><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"/></svg><span class="notif-badge">1</span></div>
          <div class="topbar-avatar" id="topbarAvatar">AR</div>
        </div>
      </header>

      <div class="page-content page-enter">
        <div class="page-header">
          <h1>Kelola QR Code</h1>
          <p>Generate QR Code untuk absensi harian peserta magang</p>
        </div>

        <!-- Date Bar -->
        <div class="qr-date-bar">
          <div class="date-info">
            <div class="date-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg></div>
            <div class="date-text">
              <h3 id="todayDate">Kamis, 5 Februari 2026</h3>
              <p>Generate QR Code untuk hari ini</p>
            </div>
          </div>
          <div class="powered-tag">
            <span>Powered by</span>
            <img src="assets/img/pln-logo-small.svg" alt="PLN">
            <span>Icon Plus</span>
          </div>
        </div>

        <!-- QR Layout -->
        <div class="qr-layout">
          <!-- Generate QR Code -->
          <div class="qr-gen-card">
            <div class="qr-gen-header">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="5" height="5" x="3" y="3" rx="1"/><rect width="5" height="5" x="16" y="3" rx="1"/><rect width="5" height="5" x="3" y="16" rx="1"/><path d="M21 16h-3a2 2 0 0 0-2 2v3"/></svg>
              <h3>Generate QR Code</h3>
            </div>
            <p class="qr-gen-sub">QR Code akan berlaku untuk hari ini saja</p>
            <div class="qr-preview-admin" id="qrPreview">
              <div class="camera-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="5" height="5" x="3" y="3" rx="1"/><rect width="5" height="5" x="16" y="3" rx="1"/><rect width="5" height="5" x="3" y="16" rx="1"/><path d="M21 16h-3a2 2 0 0 0-2 2v3"/><path d="M21 21v.01"/><path d="M12 7v3a2 2 0 0 1-2 2H7"/></svg></div>
              <span class="qr-placeholder-text">Klik tombol di bawah untuk generate QR Code</span>
            </div>
            <button class="btn btn-primary btn-full" onclick="generateQR()" style="margin-top:8px">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"/></svg>
              Generate QR Code
            </button>
          </div>

          <!-- Status + Instruksi -->
          <div>
            <div class="qr-status-card">
              <div class="qr-status-header">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
                <h3>Status QR Code Hari Ini</h3>
              </div>
              <div class="qr-status-active" id="qrStatusBadge">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                <div>
                  <div class="qsa-text">QR Code Aktif</div>
                  <div class="qsa-sub" id="qrExpiry">Berlaku hingga 5/2/2026</div>
                </div>
              </div>
              <div class="qr-status-counts">
                <div class="qr-count-box total">
                  <div class="qcb-value" id="totalPesertaQR">24</div>
                  <div class="qcb-label">Total Peserta</div>
                </div>
                <div class="qr-count-box scanned">
                  <div class="qcb-value" id="scannedCount">18</div>
                  <div class="qcb-label">Sudah Absen</div>
                </div>
              </div>
            </div>

            <div class="instruksi-card" style="margin-top:20px">
              <h3>Instruksi Penggunaan</h3>
              <div class="instruksi-list">
                <div class="instruksi-item"><div class="inst-num">1</div><div class="inst-text">Generate QR Code baru setiap hari untuk keamanan</div></div>
                <div class="instruksi-item"><div class="inst-num">2</div><div class="inst-text">Download QR Code dan tampilkan di tempat yang mudah diakses</div></div>
                <div class="instruksi-item"><div class="inst-num">3</div><div class="inst-text">Peserta magang dapat scan QR melalui menu Absensi</div></div>
                <div class="instruksi-item"><div class="inst-num">4</div><div class="inst-text">Monitor kehadiran real-time melalui Dashboard Admin</div></div>
              </div>
            </div>
          </div>
        </div>

        <!-- Daftar Kehadiran Hari Ini -->
        <div class="qr-history-card" id="attendanceCard" style="margin-bottom:20px">
          <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:8px">
            <div>
              <h3 style="display:flex;align-items:center;gap:8px">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#0a6599" stroke-width="2" style="width:20px;height:20px"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                Daftar Kehadiran Hari Ini
              </h3>
              <p style="font-size:13px;color:#94a3b8;margin-top:4px">Real-time â€” update otomatis setiap 15 detik</p>
            </div>
            <button class="btn btn-primary" onclick="loadAttendanceList()" style="padding:8px 14px;font-size:12px">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px"><path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"/></svg>
              Refresh
            </button>
          </div>
          <div id="attendanceListContainer" style="margin-top:16px">
            <div style="text-align:center;padding:24px;color:#94a3b8;font-size:14px">Memuat data kehadiran...</div>
          </div>
        </div>

        <!-- Riwayat QR Code -->
        <div class="qr-history-card">
          <h3>Riwayat QR Code</h3>
          <p class="qhc-sub">7 hari terakhir</p>
          <div class="qr-history-list" id="qrHistoryList">
            <!-- Populated by JS -->
          </div>
        </div>
      </div>
    </div>
    <button class="help-btn" onclick="showToast('Butuh bantuan? Hubungi IT Support','info')">?</button>
  </div>
  <div class="toast-container" id="toastContainer"></div>
  <script src="js/api.js"></script>

  <script>
    function checkAdminAuth(){if(!AuthAPI.isLoggedIn()){window.location.href='login.html';return null;}const u=AuthAPI.getCurrentUser();if(!u||u.role!=='admin'){window.location.href='login.html';return null;}return u;}
    function logout(){showToast('Berhasil keluar.','success');setTimeout(()=>AuthAPI.logout(),800);}
    function showToast(msg,type='info'){const c=document.getElementById('toastContainer');const icons={success:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>',error:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" x2="6" y1="6" y2="18"/><line x1="6" x2="18" y1="6" y2="18"/></svg>',info:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>'};const t=document.createElement('div');t.className=`toast ${type}`;t.innerHTML=`<div class="toast-icon">${icons[type]||icons.info}</div><span class="toast-msg">${msg}</span>`;c.appendChild(t);setTimeout(()=>t.remove(),3500);}

    document.addEventListener('DOMContentLoaded', async function() {
      const user = checkAdminAuth();
      if (user) document.getElementById('topbarAvatar').textContent = user.name.split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase();

      // Set today's date
      const now = new Date();
      document.getElementById('todayDate').textContent = now.toLocaleDateString('id-ID',{weekday:'long',day:'numeric',month:'long',year:'numeric'});

      // Load today's QR and history
      await loadTodayQR();
      await loadQRHistory();
      await loadAttendanceList();

      // Auto-refresh attendance list every 15 seconds
      setInterval(async () => {
        await loadAttendanceList();
        // Also refresh scanned count
        const qrRes = await QRCodeAPI.getToday();
        if (qrRes && qrRes.success && qrRes.data) {
          document.getElementById('scannedCount').textContent = qrRes.data.scannedBy ? qrRes.data.scannedBy.length : 0;
        }
      }, 15000);
    });

    async function loadTodayQR() {
      const res = await QRCodeAPI.getToday();
      if (res && res.success && res.data) {
        const qr = res.data;
        // Show QR code in preview â€” use URL so phone camera can open it directly
        const preview = document.getElementById('qrPreview');
        preview.innerHTML = '';
        preview.classList.add('has-qr');
        const scanUrl = window.location.origin + '/absensi-scan.html?token=' + qr.token;
        if (typeof QRCode !== 'undefined') {
          new QRCode(preview, {text:scanUrl, width:220, height:220, colorDark:'#0a6599', colorLight:'#ffffff', correctLevel:QRCode.CorrectLevel.M});
        }
        // Show token text for manual copy
        let tokenBox = document.getElementById('tokenCopyBox');
        if (!tokenBox) {
          tokenBox = document.createElement('div');
          tokenBox.id = 'tokenCopyBox';
          tokenBox.style.cssText = 'margin-top:12px;padding:10px 14px;background:#f8fafc;border:1px dashed #cbd5e1;border-radius:8px;font-size:12px;color:#64748b;text-align:center;word-break:break-all;';
          preview.parentNode.insertBefore(tokenBox, preview.nextSibling);
        }
        tokenBox.innerHTML = '<span style="font-weight:600;color:#334155">Token:</span> <code style="background:#e2e8f0;padding:2px 6px;border-radius:4px;font-size:12px;user-select:all">' + qr.token + '</code> <button onclick="navigator.clipboard.writeText(\'' + qr.token + '\');this.textContent=\'âœ“\';setTimeout(()=>this.textContent=\'Copy\',1500)" style="margin-left:6px;padding:3px 8px;font-size:11px;border:1px solid #cbd5e1;border-radius:4px;cursor:pointer;background:#fff">Copy</button>';

        // Update status
        document.getElementById('qrStatusBadge').querySelector('.qsa-text').textContent = 'QR Code Aktif';
        const today = new Date().toLocaleDateString('id-ID',{day:'numeric',month:'numeric',year:'numeric'});
        document.getElementById('qrExpiry').textContent = 'Berlaku hingga ' + today;
        document.getElementById('scannedCount').textContent = qr.scannedBy ? qr.scannedBy.length : 0;
      } else {
        document.getElementById('qrStatusBadge').querySelector('.qsa-text').textContent = 'Belum ada QR Code hari ini';
        document.getElementById('qrExpiry').textContent = 'Klik Generate untuk membuat';
        document.getElementById('scannedCount').textContent = '0';
      }

      // Load total peserta
      const usersRes = await UsersAPI.getAll();
      if (usersRes && usersRes.success) {
        document.getElementById('totalPesertaQR').textContent = usersRes.data.length;
      }
    }

    async function generateQR() {
      const res = await QRCodeAPI.generate();
      if (res && res.success) {
        showToast('QR Code berhasil di-generate!', 'success');
        const preview = document.getElementById('qrPreview');
        preview.innerHTML = '';
        preview.classList.add('has-qr');
        // Generate URL-based QR
        const scanUrl = window.location.origin + '/absensi-scan.html?token=' + res.data.token;
        if (typeof QRCode !== 'undefined') {
          new QRCode(preview, {text:scanUrl, width:220, height:220, colorDark:'#0a6599', colorLight:'#ffffff', correctLevel:QRCode.CorrectLevel.M});
        }
        // Refresh status
        await loadTodayQR();
        await loadQRHistory();
      } else {
        showToast(res ? res.message : 'Gagal generate QR Code.', 'error');
      }
    }

    async function loadQRHistory() {
      const container = document.getElementById('qrHistoryList');
      const res = await QRCodeAPI.getHistory();
      if (!res || !res.success || !res.data || res.data.length === 0) {
        container.innerHTML = '<p style="text-align:center;color:var(--gray-400);padding:20px">Belum ada riwayat QR Code</p>';
        return;
      }

      container.innerHTML = res.data.map((h,i) => {
        const dt = new Date(h.tanggal);
        const dayStr = dt.toLocaleDateString('id-ID',{weekday:'long', day:'numeric', month:'short', year:'numeric'});
        const timeStr = h.createdAt ? new Date(h.createdAt).toLocaleTimeString('id-ID',{hour:'2-digit',minute:'2-digit'}) + ' WIB' : '-';
        return `
        <div class="qr-history-item" style="animation:fadeInUp 0.3s ease ${i*0.08}s both">
          <div class="qhi-left">
            <div class="qhi-icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect width="5" height="5" x="3" y="3" rx="1"/><rect width="5" height="5" x="16" y="3" rx="1"/><rect width="5" height="5" x="3" y="16" rx="1"/></svg></div>
            <div>
              <div class="qhi-date">${dayStr}</div>
              <div class="qhi-time">Generate: ${timeStr}</div>
            </div>
          </div>
          <div class="qhi-right">
            <div class="qhi-count">${h.scannedCount || 0}</div>
            <div class="qhi-label">scan berhasil</div>
          </div>
        </div>`;
      }).join('');
    }

    async function loadAttendanceList() {
      const container = document.getElementById('attendanceListContainer');
      try {
        const res = await fetch(API_BASE + '/attendance/today', {
          headers: { 'Authorization': 'Bearer ' + getToken() }
        });
        const data = await res.json();

        if (!data.success || !data.data || data.data.length === 0) {
          container.innerHTML = `
            <div style="text-align:center;padding:32px 16px">
              <div style="font-size:40px;margin-bottom:8px">ðŸ“‹</div>
              <p style="color:#94a3b8;font-size:14px">Belum ada peserta yang absen hari ini</p>
            </div>`;
          return;
        }

        const records = data.data;
        container.innerHTML = `
          <div style="display:flex;gap:8px;margin-bottom:12px;flex-wrap:wrap">
            <span style="background:#f0fdf4;color:#16a34a;font-size:12px;font-weight:600;padding:4px 10px;border-radius:20px">
              âœ… ${records.length} Hadir
            </span>
          </div>
          <div style="overflow-x:auto">
            <table style="width:100%;border-collapse:collapse;font-size:13px">
              <thead>
                <tr style="background:#f8fafc;border-bottom:2px solid #e2e8f0">
                  <th style="padding:10px 12px;text-align:left;color:#64748b;font-weight:600;white-space:nowrap">No</th>
                  <th style="padding:10px 12px;text-align:left;color:#64748b;font-weight:600;white-space:nowrap">Nama</th>
                  <th style="padding:10px 12px;text-align:left;color:#64748b;font-weight:600;white-space:nowrap">Instansi</th>
                  <th style="padding:10px 12px;text-align:left;color:#64748b;font-weight:600;white-space:nowrap">Jam Masuk</th>
                  <th style="padding:10px 12px;text-align:left;color:#64748b;font-weight:600;white-space:nowrap">Status</th>
                </tr>
              </thead>
              <tbody>
                ${records.map((r, i) => {
                  const name = r.userId ? r.userId.name : 'Unknown';
                  const instansi = r.userId ? (r.userId.instansi || '-') : '-';
                  const initials = name.split(' ').map(n=>n[0]).join('').substring(0,2).toUpperCase();
                  const statusColor = r.status === 'Hadir' ? '#16a34a' : '#f59e0b';
                  const statusBg = r.status === 'Hadir' ? '#f0fdf4' : '#fffbeb';
                  return `<tr style="border-bottom:1px solid #f1f5f9;animation:fadeInUp 0.3s ease ${i*0.05}s both">
                    <td style="padding:10px 12px;color:#94a3b8">${i+1}</td>
                    <td style="padding:10px 12px">
                      <div style="display:flex;align-items:center;gap:10px">
                        <div style="width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,#0a6599,#4db8e8);color:#fff;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;flex-shrink:0">${initials}</div>
                        <div>
                          <div style="font-weight:600;color:#1e293b">${name}</div>
                          <div style="font-size:11px;color:#94a3b8">${r.userId ? r.userId.email : ''}</div>
                        </div>
                      </div>
                    </td>
                    <td style="padding:10px 12px;color:#64748b">${instansi}</td>
                    <td style="padding:10px 12px;font-weight:600;color:#0a6599">${r.jamMasuk || '-'}</td>
                    <td style="padding:10px 12px">
                      <span style="background:${statusBg};color:${statusColor};font-size:11px;font-weight:600;padding:3px 10px;border-radius:20px">${r.status}</span>
                    </td>
                  </tr>`;
                }).join('')}
              </tbody>
            </table>
          </div>`;
      } catch(e) {
        container.innerHTML = '<p style="text-align:center;color:#ef4444;padding:16px">Gagal memuat data kehadiran.</p>';
      }
    }
  </script>
<script>
function openSidebar(){var s=document.getElementById('sidebar'),o=document.getElementById('sidebarOverlay');if(s)s.classList.add('open');if(o)o.classList.add('active');document.body.style.overflow='hidden'}
function closeSidebar(){var s=document.getElementById('sidebar'),o=document.getElementById('sidebarOverlay');if(s)s.classList.remove('open');if(o)o.classList.remove('active');document.body.style.overflow=''}
document.addEventListener('DOMContentLoaded',function(){document.querySelectorAll('.sidebar-menu .menu-item').forEach(function(i){i.addEventListener('click',function(){if(window.innerWidth<=768)closeSidebar()})});document.addEventListener('keydown',function(e){if(e.key==='Escape')closeSidebar()});window.addEventListener('resize',function(){if(window.innerWidth>768)closeSidebar()})});
</script>
</body>
</html>
